{
    "blocks": [],
    "contracts": [
        {
            "Name": "SCNotification",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SupplyNotificSend {\n    data {\n        ChainId int\n        SenderRoleId int \n        RecipientRoleId int \n    }\n\n    conditions {\n\n        var admin_id int\n        admin_id = EcosysParam(\"role_admin\")\n        if !RoleAccess(Int(admin_id)) {\n            warning LangRes(\"@1access_denied\", \"en\")\n        }\n    }\n\n    action {\n        var params map\n        params[\"chain_id\"] = $ChainId\n\n        @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", $SenderRoleId, 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"test\", \"@1sc_act_sender\", params,1)\n        @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", $RecipientRoleId, 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"test\", \"@1sc_act_recipient\", params,1)\n\n    }\n}"
        },
        {
            "Name": "SCObject",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCObject {\n    data {\n        Name string\n        Weight int\n        Image file\n    }\n    conditions {\n        $Body = $Image[\"Body\"]\n        $ImageMimeType = $Image[\"MimeType\"]\n    }\n\n    action {\n        var m map\n        $appId = Int(DBFind(\"@1applications\").Where({ecosystem:1, name:\"supply_chain\"}).One(\"id\"))\n        $imageId = @1UploadBinary(\"ApplicationId,Name,Data,DataMimeType\", $appId, $Name, $Body, $ImageMimeType)\n        m[\"name\"] = $Name\n        m[\"weight\"] = $Weight\n        m[\"image_id\"] = $imageId\n        m[\"status\"] = 1\n\n        DBInsert(\"supply_objects\", m)\n    }\n}"
        },
        {
            "Name": "SCProcessRecipient",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCProcessRecipient {\n    data {\n        ChainID int\n        NotificId int\n        TotalStages int\n        CurrentStage int\n    }\n    conditions {\n        $stageID = DBFind(\"@1supply_stages\").Where({\"chain_id\":$ChainID,\"current_stage\":$CurrentStage}).One(\"id\")\n        $pub = DBFind(\"@1keys\").Columns(\"id,pub,ecosystem\").Where({\"id\":$key_id}).One(\"pub\")\n        $pub_sign = Sha256($pub)\n        $Template = DBFind(\"@1supply_chains\").Columns(\"id,template_id\").Where({\"id\":$ChainID}).One(\"template_id\")\n        $StageCounter = $TotalStages - 1\n        $sr = DBFind(\"@1supply_templates\").Where({\"id\":$Template}).Columns(\"id,chain\").One(\"chain\")\n        //sender signature check\n        $SenderSign = DBFind(\"@1supply_stages\").Where({\"id\":$stageID}).Columns(\"id,sender_sign\").One(\"sender_sign\")\n        if !$SenderSign {\n            warning \"Sender has not signed this act yet\"\n        }\n    }\n    action {\n        var myarr map\n        myarr = Split($sr, \",\")\n        myarr = JSONDecode($sr)\n        var i int t int\n        i = $CurrentStage\n        t = i + 1\n        if $CurrentStage == $StageCounter{\n            var m map bt string\n            bt = BlockTime()\n            m[\"status\"] = 3\n            m[\"date_end\"] = bt\n            DBUpdate(\"@1supply_chains\", $ChainID, m)\n        }\n        else{\n            var notific map params map\n            notific = myarr[t]\n            $senderId = notific[\"sender\"]\n            $recipientId = notific[\"recipient\"]\n            params[\"chain_id\"] = $ChainID\n            params[\"current_stage\"] = t\n            params[\"total_stages\"] = Int($TotalStages)\n            @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", Int($senderId), 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"Need your signature\", \"@1act_sender\", params,1)\n            @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", Int($recipientId), 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"Need your signature\", \"@1act_recipient\", params,1)\n        }\n        var n map btt string\n        btt = BlockTime()\n        n[\"recipient_sign_time\"] = btt\n        n[\"recipient_sign\"] = $pub_sign\n        DBUpdate(\"@1supply_stages\", Int($stageID), n)\n\n        //@1NotificationsClose(\"notific_id\", $notific_id)\n    }\n}"
        },
        {
            "Name": "SCProcessReject",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCProcessReject {\n    data {\n        ChainID int\n    }\n    conditions {\n\n    }\n    action {\n        var m map\n        m[\"status\"] = 4\n        DBUpdate(\"@1supply_chains\", $ChainID, m)\n    }\n}"
        },
        {
            "Name": "SCProcessSender",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCProcessSender {\n    data {\n        ChainID int\n        NotificId int\n        CurrentStage int\n        TotalStages int\n    }\n    conditions {\n        $stageID = DBFind(\"@1supply_stages\").Where({\"chain_id\":$ChainID,\"current_stage\":$CurrentStage}).One(\"id\")\n        $pub = DBFind(\"@1keys\").Columns(\"id,pub,ecosystem\").Where({\"id\":$key_id}).One(\"pub\")\n        $pub_sign = Sha256($pub)\n    }\n    action {\n        var bt string m map\n        bt = BlockTime()\n        m[\"status\"] = 2\n        DBUpdate(\"@1supply_chains\", $ChainID, m)\n\n        var n map\n        n[\"sender_sign_time\"] = bt\n        n[\"sender_sign\"] = $pub_sign\n        DBUpdate(\"@1supply_stages\", Int($stageID), n)\n\n        //@1NotificationsClose(\"notific_id\", $notific_id)\n    }\n}"
        },
        {
            "Name": "SCStart",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCStart {\n    data {\n        Object int\n        Template int\n    }\n    conditions {\n        var admin int\n        admin = Int(EcosysParam(\"role_admin\"))\n        if !RoleAccess(admin){\n            warning LangRes(\"@1access_denied\", \"en\")\n        }\n\n        $templateName = DBFind(\"@1supply_templates\").Where({\"id\":$Template}).Columns(\"id,name\").One(\"name\")\n        $objectName = DBFind(\"@1supply_objects\").Where({\"id\":$Object}).Columns(\"id,name\").One(\"name\")\n    }\n    action {\n        var bt string m map\n        bt = BlockTime()\n        m[\"object_id\"] = $Object\n        m[\"template_id\"] = $Template\n        m[\"template_name\"] = $templateName\n        m[\"object_name\"] = $objectName\n        m[\"status\"] = 1\n        m[\"date_start\"] = bt\n        $chainID = DBInsert(\"@1supply_chains\", m)\n        $result = $chainID\n\n\n        $sr = DBFind(\"@1supply_templates\").WhereId($Template).One(\"chain\")\n        var myarr map\n        myarr = Split($sr, \",\")\n        myarr = JSONDecode($sr)\n        var i int\n        while i < Len(myarr) {\n            var arr_map map n map\n            arr_map = myarr[i]\n            n[\"chain_id\"] = $chainID\n            n[\"sender_id\"] = arr_map[\"sender\"]\n            n[\"recipient_id\"] = arr_map[\"recipient\"]\n            n[\"current_stage\"] = i\n            DBInsert(\"@1supply_stages\",n)\n            i = i + 1\n        }\n        var notific map params map\n        notific = myarr[0]\n        $senderId = notific[\"sender\"]\n        $recipientId = notific[\"recipient\"]\n        $totalStages = Len(myarr)\n        params[\"chain_id\"] = $chainID\n        params[\"current_stage\"] = 0\n        params[\"total_stages\"] = Int($totalStages)\n        @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", Int($senderId), 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"Need your signature\", \"@1act_sender\", params,1)\n        @1NotificationsSend(\"rid,sender,icon_name,text_header,text_body,page_name,params_map,closure_type\", Int($recipientId), 1, \"fa-check\", LangRes(\"@1supply_chain\", \"en\"), \"Need your signature\", \"@1act_recipient\", params,1)\n        var b map\n        b[\"counter\"] = +1\n        DBUpdate(\"@1supply_templates\", Int($Template), b)\n    }\n}"
        },
        {
            "Name": "SCTemplate",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "contract SCTemplate {\n    data {\n        Steps int\n        Name string\n        Sender array\n        Recipient array\n        StartingDate array\n        StartingTime array\n        EndingDate array\n        EndingTime array\n        SupplyMap string \"optional\"\n    }\n\n    conditions {\n        var admin int\n        admin = Int(EcosysParam(\"role_admin\"))\n        if !RoleAccess(admin){\n            warning LangRes(\"@1access_denied\", \"en\")\n\n        }\n    }\n    action {\n        var i j int\n        var Trans steps map\n        var stt string\n        var json string\n        while i < Int($Steps) {\n            if i == 0 {\n                steps[\"sender\"] = $Sender[i]\n                steps[\"recipient\"] = $Recipient[i]\n                steps[\"date_start\"] = $StartingDate[i]\n                steps[\"date_end\"] = $EndingDate[i]\n                steps[\"time_start\"] = $StartingTime[i]\n                steps[\"time_end\"] = $EndingTime[i]\n            } else {\n                j = i - 1\n                steps[\"sender\"] = $Recipient[j]\n                steps[\"recipient\"] = $Recipient[i]\n                steps[\"date_start\"] = $StartingDate[j]\n                steps[\"date_end\"] = $EndingDate[j]\n                steps[\"time_start\"] = $StartingTime[j]\n                steps[\"time_end\"] = $EndingTime[j]\n            }\n            var params map\n            params[\"Trans\"] = JSONEncode(steps)\n            if i == 0 {\n                stt = \"[\" + Str(params[\"Trans\"])\n            } else{\n                stt = stt + \",\" + Str(params[\"Trans\"])\n            }\n            i = i + 1\n        }\n        json = stt + \"]\"\n        var addr map encAddr string\n        addr = JSONDecode($SupplyMap)\n        addr[\"zoom\"] = 11\n        encAddr = JSONEncode(addr)\n\n        DBInsert(\"@1supply_templates\",{name:$Name,chain:json,counter:0,deleted:0,supply_map:encAddr,total_steps:$Steps})\n    }\n}"
        }
    ],
    "data": [],
    "languages": [],
    "menus": [
        {
            "Name": "default_menu",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "    MenuItem(Title:Objects, Page:@1objects_list, Icon:\"icon-wallet\")\n    MenuItem(Title:Object create, Page:@1create_object, Icon:\"icon-speech\")\n    MenuItem(Title:$@1notifications$, Page:@1notifications_list, Icon:\"icon-flag\")\n    MenuItem(Title:Templates, Page:@1templates_list, Icon:\"icon-people\")\n    MenuItem(Title:Template create, Page:@1template_create, Icon:\"icon-note\")\n    MenuItem(Title:Create chain, Page:@1chain_create1, Icon:\"icon-graduation\")\n    MenuItem(Title:Templates, Page:@1templates_list, Icon:\"icon-people\")\n    MenuItem(Title:Template create, Page:@1template_create, Icon:\"icon-note\")\n    MenuItem(Title:Chain list, Page:@1chain_list, Icon:\"icon-graduation\")"
        }
    ],
    "pages": [
        {
            "Name": "sc_act_recipient",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "DBFind(@1notifications).Where({id:#notific_id#,ecosystem:#ecosystem_id#}).Columns(\"id,page_params->chain_id,page_params->total_stages,page_params->current_stage,ecosystem\").Vars(prefix)\nDBFind(@1supply_chains).Where({id:#prefix_page_params_chain_id#}).Vars(chains)\nDBFind(@1supply_templates).Where({id:#chains_template_id#}).Columns(\"id,chain\").Vars(templates)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\n            Form(panel panel-default){\n                Div(panel-heading text-center){\n                    Span(Class: h3, Body: $@1chain_act$)\n                }\n                Div(panel-body){\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1object_name))\n                        Span(Class: h5 text-bold, Body: #chains_object_name#)\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1template_name))\n                        Span(Class: h5 text-bold, Body: #chains_template_name#)\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@sender_must_sign_time))\n                        Div(Class: #style_text# h6 m0, Body: DateTime(DateTime: #templates_chain_time_start#, Format: \"DD.MM.YYYY\"))\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1your_must_sign_time))\n                        Div(Class: #style_text# h6 m0, Body: DateTime(DateTime: #templates_chain_time_end#, Format: \"DD.MM.YYYY\"))\n                    }\n                    Div(row){\n                        Div(col-md-6 mt-lg text-right){\n                            Button(Class: btn btn-danger mh-sm, Body: $@1reject_act$, Contract: @1SCProcessReject, Page: @1chains_list, Params: \"ChainID=#prefix_page_params_chain_id#\")\n                        }\n                        Div(col-md-6 mt-lg text-left){\n                            Button(Class: btn btn-success mh-sm, Body: $@1sign_act$, Contract: @1SCProcessRecipient, Page: @1chains_list, Params: \"ChainID=#prefix_page_params_chain_id#,notific_id=#notific_id#,CurrentStage=#prefix_page_params_current_stage#,TotalStages=#prefix_page_params_total_stages#\")\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_act_sender",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "DBFind(@1notifications).Where({id:#notific_id#,ecosystem:#ecosystem_id#}).Columns(\"id,page_params->chain_id,page_params->total_stages,page_params->current_stage,ecosystem\").Vars(prefix)\nDBFind(@1supply_chains).Where({id:#prefix_page_params_chain_id#}).Vars(chains)\nDBFind(@1supply_templates).Where({id:#chains_template_id#}).Columns(\"id,chain\").Vars(templates)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\n            Form(panel panel-default){\n                Div(panel-heading text-center){\n                    Span(Class: h3, Body: $@1chain_act$)\n                }\n                Div(panel-body){\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1object_name))\n                        Span(Class: h5 text-bold, Body: #chains_object_name#)\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1template_name))\n                        Span(Class: h5 text-bold, Body: #chains_template_name#)\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1your_must_sign_time))\n                        Div(Class: #style_text# h6 m0, Body: DateTime(DateTime: #templates_chain_time_start#, Format: \"DD.MM.YYYY\"))\n                    }\n                    Div(list-group-item text-center){\n                        Div(text-muted m0 h5, Body: LangRes(@1recipient_must_sign_time))\n                        Div(Class: #style_text# h6 m0, Body: DateTime(DateTime: #templates_chain_time_end#, Format: \"DD.MM.YYYY\"))\n                    }\n                    Div(row){\n                        Div(col-md-6 mt-lg text-right){\n                            Button(Class: btn btn-danger mh-sm, Body: $@1reject_act$, Contract: @1SCProcessReject, Page: @1chains_list, Params: \"ChainID=#prefix_page_params_chain_id#\")\n                        }\n                        Div(col-md-6 mt-lg text-left){\n                            Button(Class: btn btn-success mh-sm, Body: $@1sign_act$, Contract: @1SCProcessSenderMulti, Page: @1chains_list, Params: \"ChainID=#prefix_page_params_chain_id#,notific_id=#notific_id#,CurrentStage=#prefix_page_params_current_stage#,TotalStages=#prefix_page_params_total_stages#\")\n                        }\n                    }\n                }\n            }\n        }\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_chain_create",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page,@1sc_chain_create)\nSetTitle($create_supply_chain$)\nDiv(content-wrapper){\n    Div(row){\n        Div(col-sm-8 col-sm-offset-2 col-lg-6 col-lg-offset-3){\n            If(Or(#ObjectId#==\"\",#TemplateId#==\"\")){\n                Form(panel panel-primary){\n                    Div(panel-heading, Body: $@1supply_chain$)\n                    Div(panel-body){\n                        Div(row){\n                            Div(col-md-3 mt-sm text-right){\n                                Label(For: Object){\n                                    Span(Body: $@1object$)\n                                }\n                            }\n                            Div(col-md-9 mc-sm text-left){\n                                DBFind(@1supply_objects, src_objects)\n                                Select(Name: Object, Source: src_objects, NameColumn: name, ValueColumn: id)\n                            }\n                            Div(col-md-3 mt-sm text-right){\n                                Label(For: Template){\n                                    Span(Body: $@1template$)\n                                }\n                            }\n                            Div(col-md-9 mc-sm text-left){\n                                DBFind(@1supply_templates, src_templates)\n                                Select(Name: Template, Source: src_templates, NameColumn: name, ValueColumn: id)\n                            }\n                        }\n                    }\n\n                    Div(panel-footer pull-right){\n                        Button(Body: $@1start_chain$, Class: btn btn-primary, Page: #this_page#, PageParams: \"ObjectId=Val(Object),TemplateId=Val(Template)\")\n                    }\n                }\n            }.Else{\n                DBFind(@1supply_objects).Where({id:#ObjectId#}).Vars(objects)\n                DBFind(@1supply_templates).Where({id:#TemplateId#}).Columns(\"id,name,chain->sender_id,chain->recipient_id,chain->starting,chain->ending,chain->cords,chain->sender_role_name,chain->recipient_role_name\").Vars(templates)\n                Form(panel panel-default){\n                    Div(panel-heading text-center){\n                        Span(Class: h3, Body: $@1chain_info$)\n                    }\n                    Div(panel-body){\n                        Div(form-group){\n                            Div(row){\n                                Div(col-md-12 mt-sm text-center){\n                                    Image(Src: Binary().ById(#objects_image_id#), Class: photo).Style(height: 150px;width: 150px; border: 1px solid #5A5D63; margin-right: 10px;)\n                                }\n                            }\n                        }\n                        Div(list-group-item text-center){\n                            Div(text-muted m0 h5, Body: $@1object_name$)\n                            Span(Class: h5 text-bold, Body: #objects_name#)\n                        }\n                        Div(list-group-item text-center){\n                            Div(text-muted m0 h5, Body: $@1template_name$)\n                            Span(Class: h5 text-bold, Body: #templates_name#)\n                        }\n                        Div(list-group-item text-center){\n                            Div(text-muted m0 h5, Body: $@1sender_role$)\n                            Span(Class: h5 text-bold, Body: #templates_chain_sender_role_name#)\n                        }\n                        Div(list-group-item text-center){\n                            Div(text-muted m0 h5, Body: $@1recipient_role$)\n                            Span(Class: h5 text-bold, Body: #templates_chain_recipient_role_name#)\n                        }\n                    }\n                    Div(panel-footer text-right){\n                        Button(Class: btn btn-success, Body: $@1start_chain$, Contract: @1SCStart, Page: @1chain_list, Params: \"Object=#ObjectId#,Template=#TemplateId#)\n                    }\n                }\n            }\n        }\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_chain_view",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page, @1chain_view).(this_table, @1supply_stages)\nInclude(@1pager_header)\nSetTitle(\"$@chains$\")\nSpan(Class: text-muted h5 m0 mb ml-lg, Body: Span(Class: ml-sm, Body: \"$@chains_info$\"))\nDBFind(#this_table#, src).Where({chain_id:#chain_id#}).Columns(\"id,recipient_id,recipient_sign_time,sender_id,sender_sign_time,recipient_sign,sender_sign\")\n\nDiv(fullscreen){\n    Div(table-responsive ml-lg mr-lg){\n        Div(list-group-item){\n            Table(src, \"id=id,recipient_sign_time=recipient_sign_time,sender_sign_time=sender_sign_time,sender_id=sender_id,recipient_id=recipient_id\")\n        }.Style(\n            margin-top:-15px;\n            tbody > tr:nth-of-type(odd) {\n                background-color: #f8f9fc;\n            }\n        )\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_chains",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page, @1chain_list).(this_table, @1supply_chains)\nInclude(@1pager_header)\nSetTitle(\"$@chains$\")\nSpan(Class: text-muted h5 m0 mb ml-lg, Body: Span(Class: ml-sm, Body: \"$@chains_list$\"))\nDBFind(#this_table#, src).Custom(date_started){\n    Div(Class:h5){DateTime(DateTime: #date_start#, Format: \"YYYY.MM.DD HH:MI:SS\")}\n}.Custom(date_ended){\n    Div(Class:h5){DateTime(DateTime: #date_end#, Format: \"YYYY.MM.DD HH:MI:SS\")}\n}.Custom(custom_status){\n    If(#status#==1){\n        Div(Class: text-normal, Body: \"$@1chain_created$\")\n    }.ElseIf(#status#==2){\n        Div(Class: text-normal, Body: \"$@chain_started$\")\n    }.ElseIf(#status#==3){\n        Div(Class: text-success, Body: \"$@chain__completed$\")\n    }.ElseIf(#status#==4){\n        Div(Class: text-warning, Body: \"$@1chain_failed$\")\n    }.Else{\n        Span(\"\")\n    }\n}.Custom(custom_action){\n    Button(Body: LangRes(@1view_chain), Class: btn btn-primary, Page: @1chain_view,PageParams:\"chain_id=#id#\")\n}\nDiv(fullscreen){\n    Div(table-responsive ml-lg mr-lg){\n        Div(list-group-item){\n            Table(src, \"$@1id$=id,$@1object_name$=object_name,$@1date_start$=date_started,$@1date_end$=date_ended,$@1status$=custom_status,action=custom_action\")\n        }.Style(\n            margin-top:-15px;\n            tbody > tr:nth-of-type(odd) {\n                background-color: #f8f9fc;\n            }\n        )\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_object_create",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "Div(content-wrapper){\n    Div(row){\n        Div(col-md-8 col-md-offset-2 col-lg-6 col-lg-offset-3){\n            Form(panel panel-primary){\n                Div(panel-heading, Body: LangRes(@1creating_object))\n                Div(panel-body){\n                    Div(row){\n                        Div(col-md-12 mc-sm text-left){\n                            Div(form-group){\n                                Label(){\n                                    Span(Body: LangRes(@1object_name))\n                                    Span(Class: text-danger, Body:*)\n                                }\n                                Input(Name: Name)\n\n                                Label(){\n                                    Span(Body: LangRes(@1object_weight))\n                                    Span(Class: text-danger, Body:*)\n                                }\n                                Input(Name: Weight)\n\n                                Label(){\n                                    Span(Body: LangRes(@1object_image))\n                                    Span(Class: text-danger, Body:*)\n                                }\n                                Input(Name: image, Type: file)\n                            }\n                        }\n                    }\n                    Div(panel-footer text-left){\n                        Button(Body: LangRes(@1back), Class: btn btn-default, Page: @1create_object)\n                        Button(Body: LangRes(@1create), Class: btn btn-primary pull-right, Page: @1objects_list, Contract: @1SCObject).Alert(Text: \"$@1want_create_object$\", ConfirmButton: $@1yes$, CancelButton: $@1no$, Icon: question)\n                    }\n                }\n            }\n        }\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_objects",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page, @1objects_list).(this_table, @1supply_objects)\nInclude(@1pager_header)\n\nSetTitle(\"$@1objects$\")\nSpan(Class: text-muted h5 m0 mb ml-lg, Body: Span(Class: ml-sm, Body: \"$@1objects_list$\"))\nAddToolButton(Title: $@1create_object$, Page: @1create_object, Icon: icon-plus).Popup(Header: $@1create_object$, Width: \"50\")\n\nDBFind(#this_table#, src).Custom(custom_status){\n    If(#status#==1){\n        Div(Class: text-normal, Body: \"$@1created$\")\n    }.ElseIf(#status#==2){\n        Div(Class: text-normal, Body: \"$@1in_chain$\")\n    }.ElseIf(#status#==3){\n        Div(Class: text-success, Body: \"$@1delivered$\")\n    }.ElseIf(#status#==4){\n        Div(Class: text-warning, Body: \"$@1delivery_failed$\")\n    }.Else{\n        Span(\"\")\n    }\n}.Custom(custom_image){\n    Image(Src: Binary().ById(#image_id#), Class: photo).Style(height: 60px;width: 60px; border: 1px solid #5A5D63; margin-right: 10px;)\n}.Custom(custom_action){\n    If(#status#==1){\n        Button(Body: LangRes(@1send_by_chain), Class: btn btn-primary, Page: @1chain1)\n    }.ElseIf(#status#==2){\n        Button(Body: LangRes(@1view_chain), Class: btn btn-primary, Page: @1chain_list)\n    }.ElseIf(#status#==3){\n        Button(Body: LangRes(@1view_chain), Class: btn btn-primary, Page: @1chain_list)\n    }.ElseIf(#status#==4){\n        Button(Body: LangRes(@1view_chain), Class: btn btn-primary, Page: @1chain_list)\n    }.Else{\n        Span(\"\")\n    }\n}\nDiv(fullscreen){\n    Div(table-responsive ml-lg mr-lg){\n        Div(list-group-item){\n            Table(src, \"$@1id$=id,$@1image$=custom_image,$@1name$=name,$@1object_weight$=weight,$@1status$=custom_status,$@1action$=custom_action\")\n        }.Style(\n            margin-top:-15px;\n            tbody > tr:nth-of-type(odd) {\n                background-color: #f8f9fc;\n            }\n        )\n    }\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_template_create",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "DBFind(@1roles, src_roles).Where({ecosystem:#ecosystem_id#})\nDiv(fullscreen){\n    Div(row){\n        Div(col-sm-6 col-sm-offset-3){\n            Form(mt-lg panel panel-primary){\n                Div(panel-body){\n                    Div(row mb-sm){\n                        Div(row mb-sm){\n                            Div(col-md-4 mt-sm text-right text-bold){\n                                LangRes(template_name)\n                            }\n                            Div(col-md-8 text-left){\n                                Input(Name: Name)\n                            }\n                        }\n                        If(GetVar(cs)==\"\"){\n                            SetVar(cs,0)\n                        }\n                        If(#del# == 1){\n                            SetVar(cs,Calculate(#cs# - 1))\n                        }.Else{\n                            SetVar(cs,Calculate(#cs# + 1))\n                        }\n                        Range(params_range, 0, #cs#)\n                        ForList(Source: params_range){\n                            Div(row mb-sm){\n                                Div(col-sm-4 mt-sm text-right text-bold){\n                                    LangRes(supply_sender)\n                                }\n                                Div(col-sm-8 text-left){\n                                    Select(Name: Sender, Source: src_roles, NameColumn: role_name, ValueColumn: id)\n                                }\n                            }\n                            Div(row mb-sm){\n                                Div(col-sm-4 mt-sm text-right text-bold){\n                                    LangRes(supply_recipient)\n                                }\n                                Div(col-sm-8 text-left){\n                                    Select(Name: Recipient, Source: src_roles, NameColumn: role_name, ValueColumn: id)\n                                }\n                            }\n                            Div(row mb-sm){\n                                Div(col-sm-4 mt-sm text-right text-bold){\n                                    LangRes(supply_starting_date)\n                                }\n                                Div(col-sm-8 text-left){\n                                    Div(row){\n                                        Div(col-sm-6){\n                                            Input(Name:StartingDate, Type:date)\n                                        }\n                                        Div(col-sm-6){\n                                            Input(Name:StartingTime, Type:time, Value: \"00:00\")\n                                        }\n                                    }\n                                }\n                            }\n                            Div(row mb-sm){\n                                Div(col-sm-4 mt-sm text-right text-bold){\n                                    LangRes(supply_ending_date)\n                                }\n                                Div(col-sm-8 text-left){\n                                    Div(row){\n                                        Div(col-sm-6){\n                                            Input(Name:EndingDate, Type:date)\n                                        }\n                                        Div(col-sm-6){\n                                            Input(Name:EndingTime, Type:time, Value: \"00:00\")\n                                        }\n                                    }\n                                }\n                            }\n                        }\n                        Div(row){\n                            Div(col-md-6 mt-lg text-right){\n                                If(#cs#>1){\n                                    LinkPage(Body:$@1lstage_delete$, Page: @1template_create, PageParams:\"cs=#cs#,del=1\")\n                                }\n                            }\n                            Div(col-md-6 mt-lg text-right){\n                                LinkPage(Body:$@1lstage_add$, Page: @1template_create, PageParams:\"cs=#cs#\")\n                            }\n                        }\n                        Div(row mb-sm){\n                            Div(col-sm-8 text-left){\n                                Input(Name: Steps, Value: #cs#, Type: hidden)\n                            }\n                        }\n                        Div(row mb-sm){\n                            Div(col-sm-4 mt text-bold text-right){\n                                LangRes(supply_map)\n                            }\n                            Div(col-sm-8 text-left){\n                                InputMap(Name: SupplyMap, Type: point, MapType: streets)\n                            }\n                        }\n                    }\n                    Div(panel-footer){\n                        Button(Body: LangRes(@1back), Class: btn btn-default, Page: @1templates_list)\n                        Button(Body: $@1create$, Class: btn btn-primary pull-right, Page: @1templates_list, Contract: SCTemplate)\n                    }\n                }\n            }\n        }\n    }.Style(\n        .buttons{\n            border: 1px solid #dde6e9;\n            padding: 6px 16px;\n        }\n    )\n}",
            "Menu": "default_menu"
        },
        {
            "Name": "sc_templates",
            "Conditions": "ContractConditions(\"MainCondition\")",
            "Value": "SetVar(this_page, @1templates_list).(this_table, @1supply_templates)\nInclude(@1pager_header)\nSetTitle(\"$@1templates$\")\nSpan(Class: text-muted h5 m0 mb ml-lg, Body: Span(Class: ml-sm, Body: \"$@1templates_list$\"))\nAddToolButton(Title: Add template, Page: @1template_create, Icon: icon-plus).Popup(Header: $@1create_template$, Width: \"80\")\n\nDBFind(#this_table#, src).Columns(\"id,name,counter,supply_map,chain\").Custom(date_start){\n    Div(Class:h5){DateTime(DateTime: #chain.starting#, Format: \"YYYY.MM.DD HH:MI:SS\")}\n}.Custom(date_end){\n    Div(Class:h5){DateTime(DateTime: #chain.ending#, Format: \"YYYY.MM.DD HH:MI:SS\")}\n}\n\n\nDiv(fullscreen){\n    Div(table-responsive ml-lg mr-lg){\n        Div(list-group-item){\n            Table(src, \"$@1id$=id,$@1name$=name,chain=chain,map=supply_map,$@1template_used$=counter\").\n        }.Style(\n            margin-top:-15px;\n            tbody > tr:nth-of-type(odd) {\n                background-color: #f8f9fc;\n            }\n        )\n    }\n}",
            "Menu": "default_menu"
        }
    ],
    "parameters": [],
    "tables": [
        {
            "Name": "supply_chains",
            "Columns": "[\n    {\n        \"name\": \"date_end\",\n        \"conditions\": \"true\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"name\": \"date_start\",\n        \"conditions\": \"true\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"name\": \"finish_at\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"start_at\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"object_id\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"object_name\",\n        \"conditions\": \"true\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"status\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"template_id\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"template_name\",\n        \"conditions\": \"true\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"ecosystem\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        },
        {
            "Name": "supply_objects",
            "Columns": "[\n    {\n        \"name\": \"image_id\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCObject\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"name\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCObject\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"status\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCObject\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"weight\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCObject\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"ecosystem\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        },
        {
            "Name": "supply_stages",
            "Columns": "[\n    {\n        \"name\": \"chain_id\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"current_stage\",\n        \"conditions\": \"{\\\"update\\\":\\\"true\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"recipient_id\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"recipient_sign\",\n        \"conditions\": \"true\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"name\": \"recipient_signed_at\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"sender_id\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"sender_sign\",\n        \"conditions\": \"true\",\n        \"type\": \"varchar\"\n    },\n    {\n        \"name\": \"sender_signed_at\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"ecosystem\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        },
        {
            "Name": "supply_templates",
            "Columns": "[\n    {\n        \"name\": \"chain\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"json\"\n    },\n    {\n        \"name\": \"counter\",\n        \"conditions\": \"true\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"deleted_at\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"name\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"text\"\n    },\n    {\n        \"name\": \"supply_map\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"json\"\n    },\n    {\n        \"name\": \"total_steps\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    },\n    {\n        \"name\": \"ecosystem\",\n        \"conditions\": \"{\\\"update\\\":\\\"ContractAccess(\\\\\\\"@1SCTemplate\\\\\\\")\\\",\\\"read\\\":\\\"true\\\"}\",\n        \"type\": \"number\"\n    }\n]",
            "Permissions": "{\"insert\":\"true\",\"update\":\"true\",\"new_column\":\"true\"}"
        }
    ]
}